@using OnlineMinion.Application.Contracts.PaymentSpecShared.Responses
@using OnlineMinion.Application.Contracts.CurrencyInfo.Responses
@using OnlineMinion.Application.Contracts.PaymentSpecCash.Requests
@using OnlineMinion.SPA.Blazor.CurrencyInfo.ViewModels

@code {

  // If L18n is needed, this should be put to code-behind part and obtain translations from there.
  private static class Str
  {
    public const string Name = nameof(PaymentSpecResp.Name);
    public const string CurrencyCodeField = "Currency";
    public const string Tags = nameof(PaymentSpecResp.Tags);
    public const string Symbol = nameof(CurrencyInfoResp.Symbol);
    public const string IsoCode = nameof(CurrencyInfoResp.IsoCode);
    public const string IsoCodeField = "ISO code";
    public const string DisplayValue = nameof(CurrencyInfoVm.Display);
    public const string CurrencyCodeCannotUpdate = "Currency code cannot be updated.";
  }

}

<UpsertEditorWrapper Model="@Model" OnCancel="@OnCancel" OnSubmit="@OnSubmit" @ref="@WrapperRef">
  <EditorFormFields>
    <RadzenFormField Style="width:71%" Text="@Str.Name" Variant="@Variant.Text">
      <RadzenTextBox @bind-Value="@context.Name" Trim="@true"/>
    </RadzenFormField>
    <RadzenFormField Style="width: 25%" Text="@Str.CurrencyCodeField" Variant="@Variant.Text">
      @if (context is CreatePaymentSpecCashReq createContext)
      {
        <RadzenDropDownDataGrid
            AllowClear="@true"
            AllowFilteringByAllStringColumns="@true"
            AllowVirtualization="@true"
            @bind-Value="@createContext.CurrencyCode"
            Data="@CurrencyInfoVMs"
            Density="@Density.Compact"
            FilterCaseSensitivity="@FilterCaseSensitivity.CaseInsensitive"
            PageSize="10"
            TextProperty="@Str.DisplayValue"
            ValueProperty="@Str.IsoCode"
            VirtualizationOverscanCount="15">
          <Columns>
            <RadzenDropDownDataGridColumn Property="@Str.IsoCode" Title="@Str.IsoCodeField"/>
            <RadzenDropDownDataGridColumn Property="@Str.Symbol" Title="@Str.Symbol"/>
          </Columns>
        </RadzenDropDownDataGrid>
      }
      else if (Metadata is { } meta)
      {
        <RadzenTextBox
            Disabled="@meta.CurrencyCode.IsReadOnly"
            MouseEnter="@ShowDisabledCurrencyCodeHelp"
            Style="cursor: help"
            Value="@meta.CurrencyCode.Value"/>
      }
    </RadzenFormField>
    <RadzenFormField Style="width: 100%" Text="@Str.Tags" Variant="@Variant.Text">
      <RadzenTextBox @bind-Value="@context.Tags" Trim="@true"/>
    </RadzenFormField>
  </EditorFormFields>
</UpsertEditorWrapper>
